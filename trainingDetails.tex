%This will be a triangle inequality with differtent terms and their meenings explained.
%\TODO{Shorten the sectionm, consistency in notation.}

A multi-trajectory-prediction loss function is minimized during training. The loss consists of the classification and regression loss:

\begin{equation}
    loss = \alpha I_{class} + I_{MAE},
\end{equation}

where  MAE is mean absolute error, and $\alpha$ is a factor balancing the loss contributions. The classification loss penalizes the log probability mismatch between predicted and actual data:

\begin{equation}
    I_{class} = -\log 
    \frac{\exp (p_{m^*})}
    {\sum\limits_{1 \leq m \leq N}\exp (p_{m})},
\end{equation}
where $p_m$ are the probabilities of the predicted modes, with $m^*$ being the mode closest to the actual data.
Thus, it increases the probability of the closest sample being the true answer towards 1, while reducing the probabilities of other modes toward 0.
The regression loss tries to bring the closest prediction towards the actual data by minimizing the average misfit:

\begin{equation}
    I_{MAE} = \lVert b^* - b_{m^*} \rVert_1.
\end{equation}
